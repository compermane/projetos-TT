    1: def test_analytic_shrinkage():

           """Runs the most simple possible test: 2 variables with 12 samples.

           """

    2:     x = np.array([[-0.98511153, -0.2599713],

    1:                   [0.20374114, -0.59699234],

    1:                   [0.28570754, 0.77542166],

    1:                   [-0.78768299, 0.45808448],

    1:                   [0.80494623, -2.16308943],

    1:                   [-2.01761751, -0.27944538],

    1:                   [-0.24710646, -0.33260174],

    1:                   [0.369508, 0.57123535],

    1:                   [2.07913481, -0.0749686],

    1:                   [1.07194672, -0.69343179],

    1:                   [-0.11947645, -1.45457297],

    1:                   [-0.54877366, -1.21191041]])

       

    2:     expected = np.array([[1.04344299, 0.0335051],

    1:                          [0.0335051, 1.11112703]])

    1:     sigma_tilde = nls.shrink_cov(x, 0)

       

    1:     np.testing.assert_allclose(sigma_tilde, expected)

       

       

